# -*- coding: utf-8 -*-
# ---------------------------------------------------------------------------
# SedimentQA_ModelBuilderArcPyTemplate.py
# Created on: 2021-10-21 11:43:55.00000
#   (generated by ArcGIS/ModelBuilder)
# Usage: SedimentQA_ModelBuilderArcPyTemplate <Final_sedGrid_Raster> <Output_QA_Folder> <Datum_Adjustment_Amount> <Lake_Name> <Old_Survey_Obliques_Feature_Class> <Buffer_Distance> <MBonly_Feature_Class> 
# Description: 
# ---------------------------------------------------------------------------

# Import arcpy module
import arcpy

# Script arguments
Final_sedGrid_Raster = arcpy.GetParameterAsText(0)
if Final_sedGrid_Raster == '#' or not Final_sedGrid_Raster:
    Final_sedGrid_Raster = "E:\\HYPACK_Projects\\2020_DNR_Lakes\\2020-07_GardenCityNew\\GIS\\SedimentThickness\\GardenCityNew_SedimentThickness.gdb\\GardenCityNew_sedGrid4" # provide a default value if unspecified

Output_QA_Folder = arcpy.GetParameterAsText(1)
if Output_QA_Folder == '#' or not Output_QA_Folder:
    Output_QA_Folder = "E:\\HYPACK_Projects\\2020_DNR_Lakes\\2020-07_GardenCityNew\\GIS\\QA" # provide a default value if unspecified

Datum_Adjustment_Amount = arcpy.GetParameterAsText(2)
if Datum_Adjustment_Amount == '#' or not Datum_Adjustment_Amount:
    Datum_Adjustment_Amount = "-0.173" # provide a default value if unspecified

Lake_Name = arcpy.GetParameterAsText(3)
if Lake_Name == '#' or not Lake_Name:
    Lake_Name = "GardenCityNew" # provide a default value if unspecified

Old_Survey_Obliques_Feature_Class = arcpy.GetParameterAsText(4)
if Old_Survey_Obliques_Feature_Class == '#' or not Old_Survey_Obliques_Feature_Class:
    Old_Survey_Obliques_Feature_Class = "E:\\HYPACK_Projects\\2020_DNR_Lakes\\2020-07_GardenCityNew\\GIS\\QA\\GardenCityNew_QA.gdb\\GardenCityNew_sedQA_ob" # provide a default value if unspecified

Buffer_Distance = arcpy.GetParameterAsText(5)
if Buffer_Distance == '#' or not Buffer_Distance:
    Buffer_Distance = "0.25 Meters" # provide a default value if unspecified

MBonly_Feature_Class = arcpy.GetParameterAsText(6)
if MBonly_Feature_Class == '#' or not MBonly_Feature_Class:
    MBonly_Feature_Class = "E:\\HYPACK_Projects\\2020_DNR_Lakes\\2020-07_GardenCityNew\\GIS\\SedimentThickness\\GardenCityNew_SedimentThickness.gdb\\GardenCityNew_xyz_map_thinned4_MBonly" # provide a default value if unspecified

# Local variables:
v_Lake_Name__sedQA_obBuffer = "%QA Geodatabase%\\%Lake Name%_sedQA_obBuffer"
v_LakeName__sedQA_SPjoin_Laye = v_Lake_Name__sedQA_obBuffer
v_Lake_Name__sedQA_MBclip = "%QA Geodatabase%\\%Lake Name%_sedQA_MBclip"
v_Lake_Name__sedQA_SPjoin = "%QA Geodatabase%\\%Lake Name%_sedQA_SPjoin"
v_Lake_Name__sedQA__2_ = v_Lake_Name__sedQA_SPjoin
v_Lake_Name__sedQA__3_ = v_Lake_Name__sedQA__2_
v_Lake_Name__sedQA__4_ = v_Lake_Name__sedQA__3_
v_Lake_Name__sedQA__6_ = v_Lake_Name__sedQA__4_
GardenCityNew_sedQA = v_Lake_Name__sedQA__6_
v_Lake_Name__SedThicknessRaster_tif = "%Output QA Folder%\\%Lake Name%_SedThicknessRaster.tif"
v_LakeName__sedQA_Layer = "%LakeName%_sedQA_SPjoin_Laye"
v_Lake_Name__sedQA = "%QA Geodatabase%\\%Lake Name%_sedQA"
v_Lake_Name__sedQAtable = v_Lake_Name__sedQA
QA_Geodatabase = "%Output QA Folder%\\%Lake Name%_QA.gdb"
v_Lake_Name__sedQA_xls = "%Output QA Folder%\\%Lake Name%_sedQA.xls"

# Process: Buffer
arcpy.Buffer_analysis(Old_Survey_Obliques_Feature_Class, v_Lake_Name__sedQA_obBuffer, Buffer_Distance, "FULL", "ROUND", "NONE", "", "PLANAR")

# Process: Clip
arcpy.Clip_analysis(MBonly_Feature_Class, v_Lake_Name__sedQA_obBuffer, v_Lake_Name__sedQA_MBclip, "")

# Process: Spatial Join
arcpy.SpatialJoin_analysis(Old_Survey_Obliques_Feature_Class, v_Lake_Name__sedQA_MBclip, v_Lake_Name__sedQA_SPjoin, "JOIN_ONE_TO_ONE", "KEEP_ALL", "AREA \"AREA\" true true false 8 Double 0 0 ,First,#,E:\\HYPACK_Projects\\2020_DNR_Lakes\\2020-07_GardenCityNew\\GIS\\QA\\GardenCityNew_QA.gdb\\GardenCityNew_sedQA_ob,AREA,-1,-1;PERIMETER \"PERIMETER\" true true false 8 Double 0 0 ,First,#,E:\\HYPACK_Projects\\2020_DNR_Lakes\\2020-07_GardenCityNew\\GIS\\QA\\GardenCityNew_QA.gdb\\GardenCityNew_sedQA_ob,PERIMETER,-1,-1;OBLIQUES_ \"OBLIQUES#\" true true false 4 Long 0 0 ,First,#,E:\\HYPACK_Projects\\2020_DNR_Lakes\\2020-07_GardenCityNew\\GIS\\QA\\GardenCityNew_QA.gdb\\GardenCityNew_sedQA_ob,OBLIQUES_,-1,-1;OBLIQUES_ID \"OBLIQUES-ID\" true true false 4 Long 0 0 ,First,#,E:\\HYPACK_Projects\\2020_DNR_Lakes\\2020-07_GardenCityNew\\GIS\\QA\\GardenCityNew_QA.gdb\\GardenCityNew_sedQA_ob,OBLIQUES_ID,-1,-1;XSECT \"XSECT\" true true false 2 Short 0 0 ,First,#,E:\\HYPACK_Projects\\2020_DNR_Lakes\\2020-07_GardenCityNew\\GIS\\QA\\GardenCityNew_QA.gdb\\GardenCityNew_sedQA_ob,XSECT,-1,-1;DEPTH \"DEPTH\" true true false 4 Float 0 0 ,First,#,E:\\HYPACK_Projects\\2020_DNR_Lakes\\2020-07_GardenCityNew\\GIS\\QA\\GardenCityNew_QA.gdb\\GardenCityNew_sedQA_ob,DEPTH,-1,-1;ELEV \"ELEV\" true true false 4 Float 0 0 ,First,#,E:\\HYPACK_Projects\\2020_DNR_Lakes\\2020-07_GardenCityNew\\GIS\\QA\\GardenCityNew_QA.gdb\\GardenCityNew_sedQA_ob,ELEV,-1,-1;TINELEV \"TINELEV\" true true false 4 Float 0 0 ,First,#,E:\\HYPACK_Projects\\2020_DNR_Lakes\\2020-07_GardenCityNew\\GIS\\QA\\GardenCityNew_QA.gdb\\GardenCityNew_sedQA_ob,TINELEV,-1,-1;F_POLYGONID \"$POLYGONID\" true true false 4 Long 0 0 ,First,#,E:\\HYPACK_Projects\\2020_DNR_Lakes\\2020-07_GardenCityNew\\GIS\\QA\\GardenCityNew_QA.gdb\\GardenCityNew_sedQA_ob,F_POLYGONID,-1,-1;F_SCALE \"$SCALE\" true true false 8 Double 0 0 ,First,#,E:\\HYPACK_Projects\\2020_DNR_Lakes\\2020-07_GardenCityNew\\GIS\\QA\\GardenCityNew_QA.gdb\\GardenCityNew_sedQA_ob,F_SCALE,-1,-1;F_ANGLE \"$ANGLE\" true true false 8 Double 0 0 ,First,#,E:\\HYPACK_Projects\\2020_DNR_Lakes\\2020-07_GardenCityNew\\GIS\\QA\\GardenCityNew_QA.gdb\\GardenCityNew_sedQA_ob,F_ANGLE,-1,-1;ELEV_adj \"ELEV_adj\" true true false 8 Double 0 0 ,First,#,E:\\HYPACK_Projects\\2020_DNR_Lakes\\2020-07_GardenCityNew\\GIS\\QA\\GardenCityNew_QA.gdb\\GardenCityNew_sedQA_ob,ELEV_adj,-1,-1;Join_Count \"Join_Count\" true true false 4 Long 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA_MBclip,Join_Count,-1,-1;TARGET_FID \"TARGET_FID\" true true false 4 Long 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA_MBclip,TARGET_FID,-1,-1;CID \"CID\" true true false 4 Long 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA_MBclip,CID,-1,-1;X \"X\" true true false 8 Double 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA_MBclip,X,-1,-1;Y \"Y\" true true false 8 Double 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA_MBclip,Y,-1,-1;Z \"Z\" true true false 8 Double 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA_MBclip,Z,-1,-1;CUBE_Uncert \"CUBE_Uncert\" true true false 8 Double 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA_MBclip,CUBE_Uncert,-1,-1;Map \"Map\" true true false 4 Long 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA_MBclip,Map,-1,-1;QA \"QA\" true true false 4 Long 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA_MBclip,QA,-1,-1;Rand \"Rand\" true true false 4 Long 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA_MBclip,Rand,-1,-1;Source \"Source\" true true false 8000 Text 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA_MBclip,Source,-1,-1", "CLOSEST", "", "BufferDist")

# Process: Add Field (2)
arcpy.AddField_management(v_Lake_Name__sedQA_SPjoin, "Difference", "DOUBLE", "", "", "", "", "NULLABLE", "NON_REQUIRED", "")

# Process: Calculate Field (2)
arcpy.CalculateField_management(v_Lake_Name__sedQA__2_, "Difference", "[Z] - [ELEV_adj]", "VB", "")

# Process: Add Field (3)
arcpy.AddField_management(v_Lake_Name__sedQA__3_, "Z_Elev", "DOUBLE", "", "", "", "", "NULLABLE", "NON_REQUIRED", "")

# Process: Calculate Field (3)
arcpy.CalculateField_management(v_Lake_Name__sedQA__4_, "Z_Elev", "[Z]", "VB", "")

# Process: Copy Raster
arcpy.CopyRaster_management(Final_sedGrid_Raster, v_Lake_Name__SedThicknessRaster_tif, "", "", "-3.402823e+38", "NONE", "NONE", "", "NONE", "NONE", "TIFF", "NONE")

# Process: Add Surface Information
arcpy.AddSurfaceInformation_3d(v_Lake_Name__sedQA__6_, v_Lake_Name__SedThicknessRaster_tif, "Z", "BILINEAR", "", "1", "0", "NO_FILTER")

# Process: Make Feature Layer
arcpy.MakeFeatureLayer_management(GardenCityNew_sedQA, v_LakeName__sedQA_Layer, "", "", "OBJECTID OBJECTID VISIBLE NONE;Shape Shape VISIBLE NONE;Join_Count Join_Count VISIBLE NONE;BufferDist BufferDist VISIBLE NONE;TARGET_FID TARGET_FID VISIBLE NONE;AREA AREA VISIBLE NONE;PERIMETER PERIMETER VISIBLE NONE;OBLIQUES_ OBLIQUES_ VISIBLE NONE;OBLIQUES_ID OBLIQUES_ID VISIBLE NONE;XSECT XSECT VISIBLE NONE;DEPTH DEPTH VISIBLE NONE;ELEV ELEV VISIBLE NONE;TINELEV TINELEV VISIBLE NONE;F_POLYGONID F_POLYGONID VISIBLE NONE;F_SCALE F_SCALE VISIBLE NONE;F_ANGLE F_ANGLE VISIBLE NONE;ELEV_adj ELEV_adj VISIBLE NONE;Join_Count Join_Count VISIBLE NONE;TARGET_FID TARGET_FID VISIBLE NONE;CID CID VISIBLE NONE;X X VISIBLE NONE;Y Y VISIBLE NONE;Z Z VISIBLE NONE;CUBE_Uncert CUBE_Uncert VISIBLE NONE;Map Map VISIBLE NONE;QA QA VISIBLE NONE;Rand Rand VISIBLE NONE;Source Source VISIBLE NONE;Difference Difference VISIBLE NONE;Z_Elev Z_Elev VISIBLE NONE")

# Process: Select Layer By Location
arcpy.SelectLayerByLocation_management(v_LakeName__sedQA_Layer, "INTERSECT", v_Lake_Name__sedQA_obBuffer, "0.25 Meters", "NEW_SELECTION", "NOT_INVERT")

# Process: Copy Features
arcpy.CopyFeatures_management(v_LakeName__sedQA_SPjoin_Laye, v_Lake_Name__sedQA, "", "0", "0", "0")

# Process: Table to Table
arcpy.TableToTable_conversion(v_Lake_Name__sedQA, QA_Geodatabase, "%Lake Name%_sedQAtable", "", "Join_Count \"Join_Count\" true true false 4 Long 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA,Join_Count,-1,-1;BufferDist \"BufferDist\" true true false 8 Double 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA,BufferDist,-1,-1;TARGET_FID \"TARGET_FID\" true true false 4 Long 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA,TARGET_FID,-1,-1;AREA \"AREA\" true true false 8 Double 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA,AREA,-1,-1;PERIMETER \"PERIMETER\" true true false 8 Double 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA,PERIMETER,-1,-1;OBLIQUES_ \"OBLIQUES#\" true true false 4 Long 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA,OBLIQUES_,-1,-1;OBLIQUES_ID \"OBLIQUES-ID\" true true false 4 Long 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA,OBLIQUES_ID,-1,-1;XSECT \"XSECT\" true true false 2 Short 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA,XSECT,-1,-1;DEPTH \"DEPTH\" true true false 4 Float 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA,DEPTH,-1,-1;ELEV \"ELEV\" true true false 4 Float 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA,ELEV,-1,-1;TINELEV \"TINELEV\" true true false 4 Float 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA,TINELEV,-1,-1;F_POLYGONID \"$POLYGONID\" true true false 4 Long 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA,F_POLYGONID,-1,-1;F_SCALE \"$SCALE\" true true false 8 Double 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA,F_SCALE,-1,-1;F_ANGLE \"$ANGLE\" true true false 8 Double 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA,F_ANGLE,-1,-1;ELEV_adj \"ELEV_adj\" true true false 8 Double 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA,ELEV_adj,-1,-1;Join_Count_1 \"Join_Count\" true true false 4 Long 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA,Join_Count_1,-1,-1;TARGET_FID_1 \"TARGET_FID\" true true false 4 Long 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA,TARGET_FID_1,-1,-1;CID \"CID\" true true false 4 Long 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA,CID,-1,-1;X \"X\" true true false 8 Double 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA,X,-1,-1;Y \"Y\" true true false 8 Double 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA,Y,-1,-1;Z \"Z\" true true false 8 Double 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA,Z,-1,-1;CUBE_Uncert \"CUBE_Uncert\" true true false 8 Double 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA,CUBE_Uncert,-1,-1;Map \"Map\" true true false 4 Long 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA,Map,-1,-1;QA \"QA\" true true false 4 Long 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA,QA,-1,-1;Rand \"Rand\" true true false 4 Long 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA,Rand,-1,-1;Source \"Source\" true true false 8000 Text 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA,Source,-1,-1;Difference \"Difference\" true true false 8 Double 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA,Difference,-1,-1;Z_Elev \"Z_Elev\" true true false 8 Double 0 0 ,First,#,%QA Geodatabase%\\%Lake Name%_sedQA,Z_Elev,-1,-1", "")

# Process: Table To Excel
arcpy.TableToExcel_conversion(v_Lake_Name__sedQAtable, v_Lake_Name__sedQA_xls, "ALIAS", "CODE")

